<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéß Browser Jockey - Dual Track DJ Mixer</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üéß</text></svg>">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lamejs/1.2.0/lame.min.js"></script>
</head>
<body>
    <div class="container">
        <h1>Browser Jockey</h1>
        
        <div class="controls">
            <div class="dual-track-section">
                <div class="track-upload">
                    <label>Track 1</label>
                    
                    <div class="track-main-content">
                        <div class="upload-section">
                            <label for="audioFile1" class="upload-btn">
                                <span>üìÅ Choose Audio</span>
                                <input type="file" id="audioFile1" accept="audio/*,video/*,.mp3,.wav,.ogg,.m4a,.aac,.flac,.wma,.aiff,.aif,.opus,.webm,.oga,.mp4,.avi,.mov" hidden>
                            </label>
                            <span id="fileName1" class="file-name">No file selected</span>
                        </div>
                        <div class="waveform-container">
                            <canvas id="waveform1" class="waveform-canvas"></canvas>
                            <div id="waveformProgress1" class="waveform-progress"></div>
                            <div id="loopMarkerStart1" class="loop-marker loop-marker-start" style="display: none;">A</div>
                            <div id="loopMarkerEnd1" class="loop-marker loop-marker-end" style="display: none;">B</div>
                            <div id="loopRegion1" class="loop-region" style="display: none;"></div>
                        </div>
                        <div class="waveform-zoom-controls">
                            <button id="zoomInBtn1" class="zoom-btn" title="Zoom in">üîç+</button>
                            <button id="zoomOutBtn1" class="zoom-btn" title="Zoom out">üîç‚àí</button>
                            <button id="zoomResetBtn1" class="zoom-btn" title="Reset zoom">‚ü≤</button>
                            <span class="zoom-info">Zoom: <span id="zoomLevel1">1.0x</span></span>
                        </div>
                        <div class="track-info">
                            <span class="bpm-display">BPM: <span id="bpm1">--</span></span>
                            <span class="key-display-inline">Key: <span id="key1">--</span></span>
                            <span class="duration-display"><span id="currentTime1">0:00</span> / <span id="duration1">0:00</span></span>
                        </div>
                        <div class="waveform-color-picker">
                            <label for="waveformColor1">Waveform Color:</label>
                            <input type="color" id="waveformColor1" value="#00ffff" title="Choose waveform color">
                            <button id="resetColor1" class="reset-color-btn" title="Reset to default">‚Ü∫</button>
                        </div>
                    </div>
                    
                    <div class="track-controls-panel">
                        <div class="track-controls">
                            <button id="playBtn1" class="control-btn-small" disabled>‚ñ∂Ô∏è</button>
                            <button id="pauseBtn1" class="control-btn-small" disabled>‚è∏Ô∏è</button>
                            <button id="stopBtn1" class="control-btn-small" disabled>‚èπÔ∏è</button>
                            <button id="loopBtn1" class="control-btn-small loop-btn" disabled title="Enable loop (click waveform to set A-B points)">üîÅ</button>
                            <button id="clearLoopBtn1" class="control-btn-small" disabled title="Clear loop points">‚ùå</button>
                        </div>
                        <div class="quick-loop-section" style="display: none;" id="quickLoopSection1">
                            <label class="quick-loop-label">Quick Loop:</label>
                            <div class="quick-loop-buttons">
                                <button class="quick-loop-btn" data-bars="1" data-track="1">1 Bar</button>
                                <button class="quick-loop-btn" data-bars="2" data-track="1">2 Bars</button>
                                <button class="quick-loop-btn" data-bars="4" data-track="1">4 Bars</button>
                                <button class="quick-loop-btn" data-bars="8" data-track="1">8 Bars</button>
                            </div>
                            <label class="loop-info-label">
                                <input type="checkbox" id="autoZoom1" checked>
                                Auto-zoom to loop
                            </label>
                        </div>
                        <div class="tempo-control-inline">
                            <label>Tempo: <span id="tempoValue1">1.0x</span></label>
                            <input type="range" id="tempoSlider1" min="0.25" max="2.0" step="0.05" value="1.0">
                        </div>
                        <div class="volume-control-inline">
                            <label>Volume: <span id="volumeValue1">100%</span></label>
                            <input type="range" id="volumeSlider1" min="0" max="100" step="1" value="100" class="volume-slider">
                        </div>
                        <div class="effects-section">
                            <div class="effects-header">üéõÔ∏è Effects</div>
                            <div class="effect-control">
                                <label>Filter: <span id="filterValue1">20kHz</span></label>
                                <input type="range" id="filterSlider1" min="20" max="20000" step="10" value="20000" class="effect-slider">
                                <select id="filterType1" class="filter-type-select">
                                    <option value="lowpass">Low Pass</option>
                                    <option value="highpass">High Pass</option>
                                    <option value="bandpass">Band Pass</option>
                                </select>
                            </div>
                            <div class="effect-control">
                                <label>Reverb: <span id="reverbValue1">0%</span></label>
                                <input type="range" id="reverbSlider1" min="0" max="100" step="1" value="0" class="effect-slider">
                            </div>
                            <div class="effect-control">
                                <label>Delay: <span id="delayValue1">0%</span></label>
                                <input type="range" id="delaySlider1" min="0" max="100" step="1" value="0" class="effect-slider">
                            </div>
                            <div class="effect-control">
                                <label>Delay Time: <span id="delayTimeValue1">300ms</span></label>
                                <input type="range" id="delayTimeSlider1" min="50" max="2000" step="50" value="300" class="effect-slider">
                            </div>
                        </div>
                        <div class="export-section">
                            <div class="export-header">üíæ Export</div>
                            <div class="export-format-selector">
                                <label>Format:</label>
                                <select id="exportFormat1" class="export-format-select">
                                    <option value="wav" selected>WAV (lossless)</option>
                                    <option value="mp3">MP3 (compressed)</option>
                                </select>
                            </div>
                            <button id="exportStem1" class="export-btn" disabled>Export Track</button>
                            <button id="exportLoop1" class="export-btn" disabled>Export Loop</button>
                        </div>
                    </div>
                </div>
                
                <div class="track-upload">
                    <label>Track 2</label>
                    
                    <div class="track-main-content">
                        <div class="upload-section">
                            <label for="audioFile2" class="upload-btn">
                                <span>üìÅ Choose Audio</span>
                                <input type="file" id="audioFile2" accept="audio/*,video/*,.mp3,.wav,.ogg,.m4a,.aac,.flac,.wma,.aiff,.aif,.opus,.webm,.oga,.mp4,.avi,.mov" hidden>
                            </label>
                            <span id="fileName2" class="file-name">No file selected</span>
                        </div>
                        <div class="waveform-container">
                            <canvas id="waveform2" class="waveform-canvas"></canvas>
                            <div id="waveformProgress2" class="waveform-progress"></div>
                            <div id="loopMarkerStart2" class="loop-marker loop-marker-start" style="display: none;">A</div>
                            <div id="loopMarkerEnd2" class="loop-marker loop-marker-end" style="display: none;">B</div>
                            <div id="loopRegion2" class="loop-region" style="display: none;"></div>
                        </div>
                        <div class="waveform-zoom-controls">
                            <button id="zoomInBtn2" class="zoom-btn" title="Zoom in">üîç+</button>
                            <button id="zoomOutBtn2" class="zoom-btn" title="Zoom out">üîç‚àí</button>
                            <button id="zoomResetBtn2" class="zoom-btn" title="Reset zoom">‚ü≤</button>
                            <span class="zoom-info">Zoom: <span id="zoomLevel2">1.0x</span></span>
                        </div>
                        <div class="track-info">
                            <span class="bpm-display">BPM: <span id="bpm2">--</span></span>
                            <span class="key-display-inline">Key: <span id="key2">--</span></span>
                            <span class="duration-display"><span id="currentTime2">0:00</span> / <span id="duration2">0:00</span></span>
                        </div>
                        <div class="waveform-color-picker">
                            <label for="waveformColor2">Waveform Color:</label>
                            <input type="color" id="waveformColor2" value="#ff00ff" title="Choose waveform color">
                            <button id="resetColor2" class="reset-color-btn" title="Reset to default">‚Ü∫</button>
                        </div>
                    </div>
                    
                    <div class="track-controls-panel">
                        <div class="track-controls">
                            <button id="playBtn2" class="control-btn-small" disabled>‚ñ∂Ô∏è</button>
                            <button id="pauseBtn2" class="control-btn-small" disabled>‚è∏Ô∏è</button>
                            <button id="stopBtn2" class="control-btn-small" disabled>‚èπÔ∏è</button>
                            <button id="loopBtn2" class="control-btn-small loop-btn" disabled title="Enable loop (click waveform to set A-B points)">üîÅ</button>
                            <button id="clearLoopBtn2" class="control-btn-small" disabled title="Clear loop points">‚ùå</button>
                        </div>
                        <div class="quick-loop-section" style="display: none;" id="quickLoopSection2">
                            <label class="quick-loop-label">Quick Loop:</label>
                            <div class="quick-loop-buttons">
                                <button class="quick-loop-btn" data-bars="1" data-track="2">1 Bar</button>
                                <button class="quick-loop-btn" data-bars="2" data-track="2">2 Bars</button>
                                <button class="quick-loop-btn" data-bars="4" data-track="2">4 Bars</button>
                                <button class="quick-loop-btn" data-bars="8" data-track="2">8 Bars</button>
                            </div>
                            <label class="loop-info-label">
                                <input type="checkbox" id="autoZoom2" checked>
                                Auto-zoom to loop
                            </label>
                        </div>
                        <div class="tempo-control-inline">
                            <label>Tempo: <span id="tempoValue2">1.0x</span></label>
                            <input type="range" id="tempoSlider2" min="0.25" max="2.0" step="0.05" value="1.0">
                        </div>
                        <div class="volume-control-inline">
                            <label>Volume: <span id="volumeValue2">100%</span></label>
                            <input type="range" id="volumeSlider2" min="0" max="100" step="1" value="100" class="volume-slider">
                        </div>
                        <div class="effects-section">
                            <div class="effects-header">üéõÔ∏è Effects</div>
                            <div class="effect-control">
                                <label>Filter: <span id="filterValue2">20kHz</span></label>
                                <input type="range" id="filterSlider2" min="20" max="20000" step="10" value="20000" class="effect-slider">
                                <select id="filterType2" class="filter-type-select">
                                    <option value="lowpass">Low Pass</option>
                                    <option value="highpass">High Pass</option>
                                    <option value="bandpass">Band Pass</option>
                                </select>
                            </div>
                            <div class="effect-control">
                                <label>Reverb: <span id="reverbValue2">0%</span></label>
                                <input type="range" id="reverbSlider2" min="0" max="100" step="1" value="0" class="effect-slider">
                            </div>
                            <div class="effect-control">
                                <label>Delay: <span id="delayValue2">0%</span></label>
                                <input type="range" id="delaySlider2" min="0" max="100" step="1" value="0" class="effect-slider">
                            </div>
                            <div class="effect-control">
                                <label>Delay Time: <span id="delayTimeValue2">300ms</span></label>
                                <input type="range" id="delayTimeSlider2" min="50" max="2000" step="50" value="300" class="effect-slider">
                            </div>
                        </div>
                        <div class="export-section">
                            <div class="export-header">üíæ Export</div>
                            <div class="export-format-selector">
                                <label>Format:</label>
                                <select id="exportFormat2" class="export-format-select">
                                    <option value="wav" selected>WAV (lossless)</option>
                                    <option value="mp3">MP3 (compressed)</option>
                                </select>
                            </div>
                            <button id="exportStem2" class="export-btn" disabled>Export Track</button>
                            <button id="exportLoop2" class="export-btn" disabled>Export Loop</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="microphone-section">
                <div class="mic-header">üé§ Microphone Input</div>
                <div class="mic-controls">
                    <button id="enableMicBtn" class="control-btn">
                        <span class="mic-icon">üé§</span> Enable Microphone
                    </button>
                    <button id="disableMicBtn" class="control-btn" disabled style="display: none;">
                        <span class="mic-icon">üîá</span> Disable Microphone
                    </button>
                    <div class="mic-volume-control" style="display: none;" id="micVolumeControl">
                        <label>Mic Volume: <span id="micVolumeValue">100%</span></label>
                        <input type="range" id="micVolumeSlider" min="0" max="100" step="1" value="100" class="volume-slider">
                    </div>
                    <div class="mic-monitoring" style="display: none;" id="micMonitoring">
                        <label>
                            <input type="checkbox" id="micMonitorCheckbox">
                            Monitor (hear yourself)
                        </label>
                    </div>
                </div>
                <div class="vocoder-section" style="display: none;" id="vocoderSection">
                    <div class="vocoder-header">ü§ñ Vocoder Effect</div>
                    <div class="vocoder-controls">
                        <button id="enableVocoderBtn" class="vocoder-btn">
                            Enable Vocoder
                        </button>
                        <button id="disableVocoderBtn" class="vocoder-btn" disabled style="display: none;">
                            Disable Vocoder
                        </button>
                        <div class="vocoder-settings" style="display: none;" id="vocoderSettings">
                            <div class="vocoder-control">
                                <label>Carrier Source:</label>
                                <select id="vocoderCarrier" class="vocoder-select">
                                    <option value="track1">Track 1</option>
                                    <option value="track2">Track 2</option>
                                    <option value="mix" selected>Both Tracks (Mix)</option>
                                    <option value="mic">Microphone (Feedback)</option>
                                </select>
                            </div>
                            <div class="vocoder-control">
                                <label>Dry/Wet Mix: <span id="vocoderMixValue">100%</span></label>
                                <input type="range" id="vocoderMixSlider" min="0" max="100" step="1" value="100" class="effect-slider">
                            </div>
                            <div class="vocoder-control">
                                <label>Bands: <span id="vocoderBandsValue">16</span></label>
                                <input type="range" id="vocoderBandsSlider" min="8" max="32" step="8" value="16" class="effect-slider">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="autotune-section" style="display: none;" id="autotuneSection">
                    <div class="autotune-header">üéµ Auto-Tune Effect</div>
                    <div class="autotune-controls">
                        <button id="enableAutotuneBtn" class="autotune-btn">
                            Enable Auto-Tune
                        </button>
                        <button id="disableAutotuneBtn" class="autotune-btn" disabled style="display: none;">
                            Disable Auto-Tune
                        </button>
                        <div class="autotune-settings" style="display: none;" id="autotuneSettings">
                            <div class="autotune-control">
                                <label>Key:</label>
                                <select id="autotuneKey" class="autotune-select">
                                    <option value="C">C</option>
                                    <option value="C#">C#</option>
                                    <option value="D">D</option>
                                    <option value="D#">D#</option>
                                    <option value="E">E</option>
                                    <option value="F">F</option>
                                    <option value="F#">F#</option>
                                    <option value="G">G</option>
                                    <option value="G#">G#</option>
                                    <option value="A" selected>A</option>
                                    <option value="A#">A#</option>
                                    <option value="B">B</option>
                                </select>
                            </div>
                            <div class="autotune-control">
                                <label>Scale:</label>
                                <select id="autotuneScale" class="autotune-select">
                                    <option value="major" selected>Major</option>
                                    <option value="minor">Minor</option>
                                    <option value="chromatic">Chromatic</option>
                                </select>
                            </div>
                            <div class="autotune-control">
                                <label>Correction Speed: <span id="autotuneSpeedValue">50ms</span></label>
                                <input type="range" id="autotuneSpeedSlider" min="0" max="200" step="10" value="50" class="effect-slider">
                            </div>
                            <div class="autotune-control">
                                <label>Strength: <span id="autotuneStrengthValue">100%</span></label>
                                <input type="range" id="autotuneStrengthSlider" min="0" max="100" step="5" value="100" class="effect-slider">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="mic-waveform-container" style="display: none;" id="micWaveformContainer">
                    <label>Mic Input Level:</label>
                    <canvas id="micWaveform" class="waveform-canvas" style="height: 60px;"></canvas>
                </div>
            </div>
            
            <div class="recording-section">
                <div class="recording-controls">
                    <button id="recordBtn" class="control-btn" disabled>
                        <span class="record-icon">‚è∫Ô∏è</span> Start Recording
                    </button>
                    <button id="stopRecordBtn" class="control-btn" disabled style="display: none;">
                        <span class="record-icon">‚èπÔ∏è</span> Stop Recording
                    </button>
                    <button id="downloadBtn" class="control-btn" disabled style="display: none;">
                        <span class="record-icon">üíæ</span> Download Recording
                    </button>
                    <button id="loadToTrack1Btn" class="control-btn" disabled style="display: none;">
                        <span class="record-icon">üì•</span> Load to Track 1
                    </button>
                    <button id="loadToTrack2Btn" class="control-btn" disabled style="display: none;">
                        <span class="record-icon">üì•</span> Load to Track 2
                    </button>
                    <span id="recordingTime" class="recording-time" style="display: none;">0:00</span>
                </div>
                <div class="recording-waveform-container" style="display: none;">
                    <label>Recorded Output:</label>
                    <canvas id="recordingWaveform" class="waveform-canvas"></canvas>
                    <audio id="recordedAudio" controls></audio>
                </div>
            </div>
        </div>
        
        <div id="visualizer-container" class="visualizer-container">
            <div class="visualization-mode">
                <label>Mode:</label>
                <button id="modeCircle" class="mode-btn active">üîµ Circle</button>
                <button id="modeBars" class="mode-btn">üìä Bars</button>
                <button id="modeSphere" class="mode-btn">üåê Sphere</button>
            </div>
            
            <div id="placeholder" class="placeholder">
                <p>Upload audio files to get started</p>
                <p style="font-size: 0.9rem; margin-top: 10px;">Upload two tracks to mix them together!</p>
                <p style="font-size: 0.8rem; margin-top: 15px; color: rgba(255, 255, 255, 0.5);">
                    Supported formats: MP3, WAV, OGG, M4A, AAC, FLAC*, AIFF*, OPUS, WEBM
                </p>
                <p style="font-size: 0.7rem; margin-top: 5px; color: rgba(255, 255, 255, 0.4);">
                    *FLAC/AIFF may not play in Safari. Use Chrome/Firefox for best compatibility.
                </p>
            </div>
        </div>
        
        <audio id="audioElement1" hidden></audio>
        <audio id="audioElement2" hidden></audio>
    </div>
    
    <script src="{{ url_for('static', filename='js/visualizer-dual.js') }}"></script>
</body>
</html>